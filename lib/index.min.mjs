var e=[,(e,t,r)=>{r.r(t),r.d(t,{CompareEngine:()=>l});var a=r(2),s=r(4),n=r(5);class l{determineArrayIndexFn;compareStateIndex;arrayIndex;panels;constructor(e,t,r){this.determineArrayIndexFn=e,this.compareStateIndex={left:new Map,right:new Map},this.arrayIndex={left:new Map,right:new Map},this.panels={left:t,right:r}}_logsEnabled=!1;set logsEnabled(e){this._logsEnabled=e}get leftValue(){return n.TypeHelper.deepClone(this.panels[s.PanelEnum.LEFT])}get rightValue(){return n.TypeHelper.deepClone(this.panels[s.PanelEnum.RIGHT])}updateLeft(e){this.update(s.PanelEnum.LEFT,e)}updateInLeft(e,t){this.updateIn(s.PanelEnum.LEFT,e,t)}updateRight(e){this.update(s.PanelEnum.RIGHT,e)}updateInRight(e,t){this.updateIn(s.PanelEnum.RIGHT,e,t)}leftToRight(){this.updateRight(this.panels[s.PanelEnum.LEFT])}rightToLeft(){this.updateLeft(this.panels[s.PanelEnum.RIGHT])}updateCompareIndex(){this.compareStateIndex[s.PanelEnum.LEFT].clear(),this.compareStateIndex[s.PanelEnum.RIGHT].clear(),this.compare(s.PanelEnum.LEFT,this.panels[s.PanelEnum.LEFT]),this.compare(s.PanelEnum.RIGHT,this.panels[s.PanelEnum.RIGHT])}hasChange(){return this.compareStateIndex.right.get("")?.isChanged??!1}getInLeft(e){return n.TreeHelper.getIn(this.panels.left,n.TypeHelper.isArray(e)?e:[e])}getLeftState(e){return this.getState(s.PanelEnum.LEFT,e)}getInRight(e){return n.TreeHelper.getIn(this.panels.right,n.TypeHelper.isArray(e)?e:[e])}getRightState(e){return this.getState(s.PanelEnum.RIGHT,e)}getState(e,t){const r=n.Path.from(n.TypeHelper.isArray(t)?t:[t]);return this._logsEnabled&&console.log(`- [${e}] Get state :`,t,r),this.compareStateIndex[e].get(r.toString())??a.CompareState.NONE}update(e,t){this.panels[e]=n.TypeHelper.deepClone(t),this.arrayIndex[e].clear()}updateIn(e,t,r){n.TreeHelper.setIn(this.panels[e],r,n.TypeHelper.deepClone(t)),this.arrayIndex[e].clear()}findArrayDiffLevels(e,t,r=0,a=[],s=!1){const n=t.slice(0,r),l=this.arrayIndex[e].get(n.toString())??!1;return s&&(console.log("--- findArrayDiffLevels : level ",r," with path ",t),console.log("--- findArrayDiffLevels : currentPath '",n,"' is array ? ",l)),a.length>0&&(a=a.map((e=>e+1))),l&&a.push(0),r<t.length?this.findArrayDiffLevels(e,t,r+1,a,s):a}findCompareItem(e,t,r){let a;if(r&&n.TreeHelper.hasProperty(e,[r])&&n.ObjectHelper.hasStringIndex(e))a=t.findIndex((t=>t[r]===e[r]));else{a=t.map((e=>JSON.stringify(e))).indexOf(JSON.stringify(e))}return{index:a,value:t[a]}}comparePropertyValues(e,t,r,s,l=!1){if(l&&(console.log("--- Compare property value",s.toString(),n.TreeHelper.hasProperty(r,s)?"exist":"not exist"),console.log("--- in object",r)),!n.TreeHelper.hasProperty(r,s))return this.getIncomparableState(e);const i=n.TreeHelper.getIn(r,s);return l&&(console.log("--- Is equal ?",n.TypeHelper.isEqual(t,i)),console.log("--- Other side value",i)),n.TypeHelper.isEqual(t,i)?a.CompareState.EQUAL:a.CompareState.UPDATED}getIncomparableState(e){return e===s.PanelEnum.LEFT?a.CompareState.REMOVED:a.CompareState.ADDED}compareValues(e,t){return n.TypeHelper.isEqual(e,t)?a.CompareState.EQUAL:a.CompareState.UPDATED}compare(e,t,r=new n.Path){let l,i=this._logsEnabled,o=a.CompareState.NONE;const p=e===s.PanelEnum.LEFT?s.PanelEnum.RIGHT:s.PanelEnum.LEFT;n.TypeHelper.isEvaluable(t)&&!n.TypeHelper.isPrimitive(t)&&this.arrayIndex[e].set(r.toString(),n.TypeHelper.isArray(t)),i&&(console.log(`- [${e}] ${r}`),console.log("-- Side value : ",t));const u=this.findArrayDiffLevels(e,r,0,[],i);i&&console.log("-- Array diffs : ",u);let c=this.panels[e],y=this.panels[p],g=r.clone(),h=n.TypeHelper.deepClone(t);if(u.length>0?u.forEach((t=>{const r=g.slice(0,g.length-t),s=n.TreeHelper.getIn(y,r);if(i&&(console.log("--- Current array diff : ",t),console.log("--- Current root : ",c),console.log("--- Current side value : ",h),console.log("--- Array path : ",r),console.log("--- Other side items : ",s),console.log("--- Other side is array ?",n.TypeHelper.isArray(s))),n.TypeHelper.isArray(s))if(0===t)h=n.TreeHelper.getIn(c,r),i&&(console.log("-- Array diff 0"),console.log("-- Property path : ",r),console.log("-- Compare : ",h),console.log("-- With : ",s)),o=this.comparePropertyValues(e,h,y,r,i);else{const p=this.determineArrayIndexFn?this.determineArrayIndexFn(g):"",u=g.slice(0,r.length+1),d=n.TreeHelper.getIn(c,u),m=this.findCompareItem(d,s,p),E=m.value;if(i&&(console.log("-- Object path : ",u),console.log("-- Side object : ",d),console.log("-- Item finded ? ",m)),E){const r=g.slice(u.length);if(1===t){const e=g.last();if(void 0!==e){h=n.TreeHelper.getIn(d,r),i&&(console.log("-- Array diff 1",r),console.log("-- Other side value : ",m.value),console.log("-- Indexes : ",e,m.index));const t=this.compareValues(e,m.index),s=this.compareValues(h,m.value);i&&(console.log("-- compare index : ",t.value),console.log("-- compare value : ",s.value)),o=t.isUpdated&&s.isEqual?a.CompareState.MOVED:s.isUpdated?a.CompareState.UPDATED:a.CompareState.EQUAL}}else h=n.TreeHelper.getIn(d,r),i&&(l=n.TreeHelper.getIn(E,r),console.log("-- Array diff > 1",r),console.log("-- Other side object : ",E),console.log("-- Other side value : ",l)),o=this.comparePropertyValues(e,h,E,r,i);g=r.clone(),c=n.TypeHelper.deepClone(d),h=n.TypeHelper.deepClone(d),y=n.TypeHelper.deepClone(E),i&&(l=n.TypeHelper.deepClone(E))}else o=this.getIncomparableState(e)}else h=n.TreeHelper.getIn(c,r),i&&(console.log("-- No other side array"),console.log("-- Compare",h),console.log("-- With",s)),o=this.comparePropertyValues(e,h,y,r,i)})):(o=this.comparePropertyValues(e,h,this.panels[p],r),i&&(l=n.TreeHelper.getIn(this.panels[p],r),console.log("-- No array upside"),console.log("-- Other side value : ",l))),i&&console.log("-- Update state with : ",o.value),this.compareStateIndex[e].set(r.toString(),o),o.isUpdated&&n.TypeHelper.isTree(t)){const a=n.TreeHelper.keys(t);i&&console.log("-- Sub keys : ",a),a.forEach((a=>{const s=r.clone().add(a);this._logsEnabled&&console.log("-- Sub path :",r,"+",a,"=>",s);const l=n.TypeHelper.isArray(t)?t[n.MathHelper.parseInt(a)]:t[a];this.compare(e,l,s)}))}}}},(e,t,r)=>{r.r(t),r.d(t,{CompareState:()=>s});var a=r(3);class s{_value;constructor(e=a.CompareStateEnum.NONE){this._value=e}static get NONE(){return new s}static get ADDED(){return new s(a.CompareStateEnum.ADDED)}static get MOVED(){return new s(a.CompareStateEnum.MOVED)}static get UPDATED(){return new s(a.CompareStateEnum.UPDATED)}static get REMOVED(){return new s(a.CompareStateEnum.REMOVED)}static get EQUAL(){return new s(a.CompareStateEnum.EQUAL)}get value(){return this._value}get isNone(){return this._value===a.CompareStateEnum.NONE}get isAdded(){return this._value===a.CompareStateEnum.ADDED}get isMoved(){return this._value===a.CompareStateEnum.MOVED}get isUpdated(){return this._value===a.CompareStateEnum.UPDATED}get isRemoved(){return this._value===a.CompareStateEnum.REMOVED}get isEqual(){return this._value===a.CompareStateEnum.EQUAL}get isChanged(){return this._value!==a.CompareStateEnum.EQUAL}toString(){return this.value}}},(e,t,r)=>{var a;r.r(t),r.d(t,{CompareStateEnum:()=>a}),function(e){e.NONE="",e.ADDED="added",e.MOVED="moved",e.UPDATED="updated",e.REMOVED="removed",e.EQUAL="equal"}(a||(a={}))},(e,t,r)=>{var a;r.r(t),r.d(t,{PanelEnum:()=>a}),function(e){e.LEFT="left",e.RIGHT="right"}(a||(a={}))},(e,t,r)=>{r.r(t),r.d(t,{ArrayHelper:()=>i,CONSOLE_LOG_STYLES:()=>o,ConsoleHelper:()=>p,DateHelper:()=>u,MathHelper:()=>c,ObjectHelper:()=>y,Path:()=>g,PrimitiveClassNames:()=>h,SmartMap:()=>d,StringHelper:()=>m,TreeHelper:()=>E,TypeHelper:()=>T,TypeState:()=>H,TypeStateEnum:()=>f});var a=[,(e,t,r)=>{r.r(t),r.d(t,{ArrayHelper:()=>a.ArrayHelper,ConsoleHelper:()=>s.ConsoleHelper,DateHelper:()=>n.DateHelper,MathHelper:()=>l.MathHelper,ObjectHelper:()=>i.ObjectHelper,StringHelper:()=>o.StringHelper,TreeHelper:()=>p.TreeHelper,TypeHelper:()=>u.TypeHelper});var a=r(2),s=r(3),n=r(18),l=r(17),i=r(6),o=r(5),p=r(12),u=r(4)},(e,t,r)=>{r.r(t),r.d(t,{ArrayHelper:()=>a});class a{}},(e,t,r)=>{r.r(t),r.d(t,{ConsoleHelper:()=>n});var a=r(4),s=r(12);class n{static group(e,t,r){const a=n.format(e);n.log(a.title,r&&r[0]?r[0]:"",!0,...a.data??[]),t.forEach(((e,t)=>{const a=n.format(e);n.log(a.title,r&&r[t+1]?r[t+1]:"",!1,...a.data??[])})),console.groupEnd()}static log(e,t,r=!1,...a){(r?console.group:console.log).call(console,`%c ${e}`,t,...a)}static format(e){return a.TypeHelper.isString(e)?{title:e}:void 0!==e.title&&1===s.TreeHelper.keys(e).length?e:void 0!==e.title&&void 0!==e.data&&2===s.TreeHelper.keys(e).length?{title:e.title,data:a.TypeHelper.isArray(e.data)?e.data:[e.data]}:{title:e.title??"",data:a.TypeHelper.isArray(e)?e:[e]}}}},(e,t,r)=>{r.r(t),r.d(t,{TypeHelper:()=>o});var a=r(5),s=r(6),n=r(12),l=r(13),i=r(7);class o{static isEvaluable(e){return null!=e}static getPrototypeOf(e){return Object.getPrototypeOf(e)??{}}static isBoolean(e){return o.isEvaluable(e)&&("boolean"==typeof e||o.getPrototypeOf(e).constructor===Boolean)}static isKey(e){return o.isEvaluable(e)&&(o.isNumber(e)||o.isString(e))}static isNumber(e){return o.isEvaluable(e)&&("number"==typeof e||o.getPrototypeOf(e).constructor===Number)&&!isNaN(+a.StringHelper.stringify(e))}static isSymbol(e){return o.isEvaluable(e)&&("symbol"==typeof e||o.getPrototypeOf(e).constructor===Symbol)}static isString(e){return o.isEvaluable(e)&&("string"==typeof e||o.getPrototypeOf(e).constructor===String)}static isArray(e){return o.isEvaluable(e)&&Array.isArray(e)}static isRecord(e){return o.isEvaluable(e)&&"object"==typeof e&&"Object"===o.getPrototypeOf(e).constructor.name}static isObject(e){return o.isEvaluable(e)&&"object"==typeof e&&-1===[...i.PrimitiveClassNames,"Array","Object"].indexOf(o.getPrototypeOf(e).constructor.name)}static isTree(e){return o.isArray(e)||s.ObjectHelper.hasStringIndex(e)}static isFunction(e){return o.isEvaluable(e)&&("function"==typeof e||e instanceof Function||"[object Function]"===a.StringHelper.stringify(e))}static isDate(e){return o.isObject(e)&&"Date"===o.getPrototypeOf(e).constructor.name}static isT(e){return e}static isPrimitive(e){return o.isEvaluable(e)&&!o.isTree(e)&&!o.isFunction(e)}static isEqual(e,t){const r=new l.TypeState(e);let a=new l.TypeState(t);const s=Object.is(o.serialize(e),o.serialize(t));if(s){const s=Object.is(r.type,a.type);return s&&r.isObject&&a.isObject?Object.is(o.getPrototypeOf(e),o.getPrototypeOf(t)):s}return s}static serialize(e){const t=n.TreeHelper.flat(e);return o.isString(t)?t:JSON.stringify(t)}static deepClone(e){if(o.isArray(e))return e.map((e=>o.deepClone(e)));if(o.isDate(e))return new Date(e);if(s.ObjectHelper.hasStringIndex(e)){const t=n.TreeHelper.getCycles(e),r=o.getPrototypeOf(e);return n.TreeHelper.keys(e).filter((e=>-1===t.indexOf(e))).reduce(((t,r)=>{const a=Object.getOwnPropertyDescriptor(e,r);return void 0!==a&&Object.defineProperty(t,r,a),t[r]=o.deepClone(e[r]),t}),r?Object.create(r):{})}return e}}},(e,t,r)=>{r.r(t),r.d(t,{StringHelper:()=>s});var a=r(4);class s{static stringify(e){return a.TypeHelper.isEvaluable(e)?void 0!==typeof e.toString||a.TypeHelper.isSymbol(e)?e.toString():e+"":null===e?"null":"undefined"}}},(e,t,r)=>{r.r(t),r.d(t,{ObjectHelper:()=>n});var a=r(4),s=r(7);class n{static hasStringIndex(e){return a.TypeHelper.isEvaluable(e)&&"object"==typeof e&&-1===[...s.PrimitiveClassNames,"Array"].indexOf(a.TypeHelper.getPrototypeOf(e).constructor.name)}}},(e,t,r)=>{r.r(t),r.d(t,{CONSOLE_LOG_STYLES:()=>a.CONSOLE_LOG_STYLES,PrimitiveClassNames:()=>s.PrimitiveClassNames});var a=r(8),s=(r(9),r(10));r(11)},(e,t,r)=>{r.r(t),r.d(t,{CONSOLE_LOG_STYLES:()=>a});const a={blue:"color: #2196F3; font-weight: bold",grey:"color: #FD8182; font-weight: bold",green:"color: #BADA55; font-weight: bold",red:"color: #FD8182; font-weight: bold"}},(e,t,r)=>{r.r(t)},(e,t,r)=>{r.r(t),r.d(t,{PrimitiveClassNames:()=>a});const a=["Boolean","Number","String"]},(e,t,r)=>{r.r(t)},(e,t,r)=>{r.r(t),r.d(t,{TreeHelper:()=>o});var a=r(13),s=r(6),n=r(17),l=r(4),i=r(5);class o{static keys(e){return l.TypeHelper.isEvaluable(e)?l.TypeHelper.isArray(e)?Object.keys(e).map((e=>parseInt(e))):Object.getOwnPropertyNames(e):[]}static getIn(e,t){let r=e,a=0;if(r)for(;a<t.length;){const e=t[a];r=s.ObjectHelper.hasStringIndex(r)?r[e]:l.TypeHelper.isArray(r)?r[n.MathHelper.parseInt(e)]:void 0,a++}return r}static setIn(e,t,r){const a=l.TypeHelper.isArray(t)?t:[t];let i=e,o=0;if(i)for(;o<a.length;){const e=a[o],t=o===a.length-1;s.ObjectHelper.hasStringIndex(i)?t?i[e]=r:i=i[e]:l.TypeHelper.isArray(i)?t?i[n.MathHelper.parseInt(e)]=r:i=i[n.MathHelper.parseInt(e)]:i=void 0,o++}return e}static hasProperty(e,t){if(l.TypeHelper.isKey(t)&&(t=[t]),0===t.length)return!0;if(!l.TypeHelper.isEvaluable(e)||!l.TypeHelper.isTree(e))return!1;let r=t[0];if(1===t.length)return o.hasOwn(e,r);if(!o.hasOwn(e,r))return!1;const a=(l.TypeHelper.isNumber(r),e[r]);return!!l.TypeHelper.isTree(a)&&o.hasProperty(a,t.slice(1))}static hasOwn(e,t){return l.TypeHelper.isArray(e)&&l.TypeHelper.isNumber(t)?t<e.length:Object.hasOwn(e,t)}static flat(e){const t=new a.TypeState(e);if(!t.isValuable||t.isPrimitive||t.isFunction)return l.TypeHelper.isString(e)?`"${e}"`:i.StringHelper.stringify(e);if(l.TypeHelper.isDate(e))return e;if(l.TypeHelper.isTree(e)){const r=t.isArray?[]:{};return o.keys(e).forEach((t=>{l.TypeHelper.isArray(e)?r[t]=o.flat(e[n.MathHelper.parseInt(t)]):s.ObjectHelper.hasStringIndex(e)&&(r[t]=o.flat(e[t]))})),r}return e}static getCycles(e){if(!l.TypeHelper.isEvaluable(e))return[];const t=new Set,r=[],s=function(e,i=new a.Path){t.has(e)?r.push(i):(t.add(e),o.keys(e).forEach((t=>{const r=i.clone();r.push(t);const a=l.TypeHelper.isArray(e)?e[n.MathHelper.parseInt(t)]:e[t];l.TypeHelper.isTree(a)&&s(a,r)})))};return s(e),r.map((e=>e.toString()))}}},(e,t,r)=>{r.r(t),r.d(t,{Path:()=>a.Path,SmartMap:()=>s.SmartMap,TypeState:()=>n.TypeState,TypeStateEnum:()=>n.TypeStateEnum});var a=r(14),s=r(15),n=r(16)},(e,t,r)=>{r.r(t),r.d(t,{Path:()=>s});var a=r(1);class s extends Array{add(e){return super.push(e),this}clone(){return this.slice()}slice(e,t){const r=new s;return r.push(...super.slice(e,t)),r}toString(){return this.reduce(((e,t)=>e+(a.TypeHelper.isNumber(t)?`[${t}]`:`${""===e?"":"."}${t}`)),"")}last(){return this.length>0?this[this.length-1]:void 0}}},(e,t,r)=>{r.r(t),r.d(t,{SmartMap:()=>a});class a extends Map{_keys=[];_values=[];constructor(e=[]){super(e),this._keys=e.map((e=>e[0])),this._values=e.map((e=>e[1]))}get(e){return super.get(e)}set(e,t){if(this.has(e)){const r=this._keys.indexOf(e);this._values[r]=t}else this._keys.push(e),this._values.push(t);return super.set(e,t),this}getKeys(){return this._keys}getValues(){return this._values}map(e){return this._keys.map(((t,r)=>e(this._values[r],t,r)))}each(e){this._keys.forEach(((t,r)=>{e(this._values[r],t,r)}))}find(e){return this._values.find(((t,r)=>e(t,this._keys[r],r)))}filter(e){const t=new a;return this._keys.filter(((t,r)=>e(this._values[r],t,r))).forEach((e=>t.set(e,this.get(e)))),t}}},(e,t,r)=>{r.r(t),r.d(t,{TypeState:()=>n,TypeStateEnum:()=>a});var a,s=r(1);!function(e){e.NO_EVALUABLE="no_evaluable",e.PRIMITIVE="primitive",e.OBJECT="object",e.RECORD="record",e.ARRAY="array",e.FUNCTION="function"}(a||(a={}));class n{_type;constructor(e){null==e?this._type=a.NO_EVALUABLE:s.TypeHelper.isArray(e)?this._type=a.ARRAY:s.TypeHelper.isRecord(e)?this._type=a.RECORD:s.TypeHelper.isObject(e)?this._type=a.OBJECT:s.TypeHelper.isFunction(e)?this._type=a.FUNCTION:this._type=a.PRIMITIVE}get type(){return this._type}get isValuable(){return this._type!==a.NO_EVALUABLE}get isPrimitive(){return this._type===a.PRIMITIVE}get isArray(){return this._type===a.ARRAY}get isObject(){return this._type===a.OBJECT}get isRecord(){return this._type===a.RECORD}get isFunction(){return this._type===a.FUNCTION}}},(e,t,r)=>{r.r(t),r.d(t,{MathHelper:()=>s});var a=r(4);class s{static parseInt(e){return a.TypeHelper.isNumber(e)?e:parseInt(e)}}},(e,t,r)=>{r.r(t),r.d(t,{DateHelper:()=>a});class a{}},(e,t,r)=>{r.r(t),r(20)},(e,t,r)=>{r.r(t)}],s={};function n(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={exports:{}};return a[e](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};(()=>{n.r(l),n.d(l,{ArrayHelper:()=>e.ArrayHelper,CONSOLE_LOG_STYLES:()=>t.CONSOLE_LOG_STYLES,ConsoleHelper:()=>e.ConsoleHelper,DateHelper:()=>e.DateHelper,MathHelper:()=>e.MathHelper,ObjectHelper:()=>e.ObjectHelper,Path:()=>r.Path,PrimitiveClassNames:()=>t.PrimitiveClassNames,SmartMap:()=>r.SmartMap,StringHelper:()=>e.StringHelper,TreeHelper:()=>e.TreeHelper,TypeHelper:()=>e.TypeHelper,TypeState:()=>r.TypeState,TypeStateEnum:()=>r.TypeStateEnum});var e=n(1),t=(n(19),n(7)),r=n(13)})();var i=l.ArrayHelper,o=l.CONSOLE_LOG_STYLES,p=l.ConsoleHelper,u=l.DateHelper,c=l.MathHelper,y=l.ObjectHelper,g=l.Path,h=l.PrimitiveClassNames,d=l.SmartMap,m=l.StringHelper,E=l.TreeHelper,T=l.TypeHelper,H=l.TypeState,f=l.TypeStateEnum}],t={};function r(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{r.r(a),r.d(a,{CompareEngine:()=>e.CompareEngine,CompareState:()=>s.CompareState,CompareStateEnum:()=>t.CompareStateEnum});var e=r(1),t=r(3),s=r(2)})();var s=a.CompareEngine,n=a.CompareState,l=a.CompareStateEnum;export{s as CompareEngine,n as CompareState,l as CompareStateEnum};