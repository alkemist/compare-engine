var e=[,(e,t,r)=>{r.r(t),r.d(t,{CompareHelper:()=>s});var a=r(2),n=r(3);const o=["Boolean","Number","String"];class s{static isEvaluable(e){return null!=e}static isBoolean(e){return s.isEvaluable(e)&&("boolean"==typeof e||Object.getPrototypeOf(e).constructor===Boolean)}static isKey(e){return s.isEvaluable(e)&&(s.isNumber(e)||s.isString(e))}static isNumber(e){return s.isEvaluable(e)&&("number"==typeof e||Object.getPrototypeOf(e).constructor===Number)&&!isNaN(+s.stringify(e))}static isSymbol(e){return s.isEvaluable(e)&&("symbol"==typeof e||Object.getPrototypeOf(e).constructor===Symbol)}static isString(e){return s.isEvaluable(e)&&("string"==typeof e||Object.getPrototypeOf(e).constructor===String)}static isArray(e){return s.isEvaluable(e)&&Array.isArray(e)}static isRecord(e){return s.isEvaluable(e)&&"object"==typeof e&&"Object"===Object.getPrototypeOf(e).constructor.name}static isObject(e){return s.isEvaluable(e)&&"object"==typeof e&&-1===[...o,"Array","Object"].indexOf(Object.getPrototypeOf(e).constructor.name)}static hasStringIndex(e){return s.isEvaluable(e)&&"object"==typeof e&&-1===[...o,"Array"].indexOf(Object.getPrototypeOf(e).constructor.name)}static isTree(e){return s.isArray(e)||s.hasStringIndex(e)}static isFunction(e){return s.isEvaluable(e)&&("function"==typeof e||e instanceof Function||"[object Function]"===s.stringify(e))}static isDate(e){return s.isObject(e)&&"Date"===Object.getPrototypeOf(e).constructor.name}static isT(e){return e}static isPrimitive(e){return s.isEvaluable(e)&&!s.isTree(e)&&!s.isFunction(e)}static isEqual(e,t){const r=new a.TypeState(e);let n=new a.TypeState(t);const o=Object.is(s.serialize(e),s.serialize(t));if(o){const a=Object.is(r.type,n.type);return a&&r.isObject&&n.isObject?Object.is(Object.getPrototypeOf(e).constructor.name,Object.getPrototypeOf(t).constructor.name):a}return o}static keys(e){return s.isEvaluable(e)?s.isArray(e)?Object.keys(e).map((e=>parseInt(e))):Object.getOwnPropertyNames(e):[]}static deepClone(e){if(s.isArray(e))return e.map(((e,t)=>s.deepClone(e)));if(s.isDate(e))return new Date(e);if(s.hasStringIndex(e)){const t=s.getCycles(e);return s.keys(e).filter((e=>-1===t.indexOf(e))).reduce(((t,r)=>{const a=Object.getOwnPropertyDescriptor(e,r);return void 0!==a&&Object.defineProperty(t,r,a),t[r]=s.deepClone(e[r]),t}),Object.create(Object.getPrototypeOf(e)))}return e}static getCycles(e){if(!s.isEvaluable(e))return[];const t=new Set,r=[],a=function(e,o=new n.Path){t.has(e)?r.push(o):(t.add(e),s.keys(e).forEach((t=>{const r=o.clone();r.push(t);const n=s.isArray(e)?e[s.parseInt(t)]:e[t];s.isTree(n)&&a(n,r)})))};return a(e),r.map((e=>e.toString()))}static getIn(e,t){let r=e,a=0;if(r)for(;a<t.length;){const e=t[a];r=s.hasStringIndex(r)?r[e]:s.isArray(r)?r[s.parseInt(e)]:void 0,a++}return r}static parseInt(e){return s.isNumber(e)?e:parseInt(e)}static hasOwn(e,t){return s.isArray(e)&&s.isNumber(t)?t<e.length:Object.hasOwn(e,t)}static hasProperty(e,t){if(s.isKey(t)&&(t=[t]),0===t.length)return!0;if(!s.isEvaluable(e)||!s.isTree(e))return!1;let r=t[0];if(1===t.length)return s.hasOwn(e,r);if(!s.hasOwn(e,r))return!1;const a=(s.isNumber(r),e[r]);return!!s.isTree(a)&&s.hasProperty(a,t.slice(1))}static serialize(e){const t=s.flat(e);return s.isString(t)?t:JSON.stringify(t)}static stringify(e){return s.isEvaluable(e)?void 0!==typeof e.toString||s.isSymbol(e)?e.toString():e+"":null===e?"null":"undefined"}static flat(e){const t=new a.TypeState(e);if(!t.isValuable||t.isPrimitive||t.isFunction)return s.isString(e)?`"${e}"`:s.stringify(e);if(s.isDate(e))return e;if(s.isTree(e)){const r=t.isArray?[]:{};return s.keys(e).forEach((t=>{s.isArray(e)?r[t]=s.flat(e[s.parseInt(t)]):s.hasStringIndex(e)&&(r[t]=s.flat(e[t]))})),r}return e}}},(e,t,r)=>{r.r(t),r.d(t,{TypeState:()=>o,TypeStateEnum:()=>a});var a,n=r(1);!function(e){e.NO_EVALUABLE="no_evaluable",e.PRIMITIVE="primitive",e.OBJECT="object",e.RECORD="record",e.ARRAY="array",e.FUNCTION="function"}(a||(a={}));class o{_type;constructor(e){null==e?this._type=a.NO_EVALUABLE:n.CompareHelper.isArray(e)?this._type=a.ARRAY:n.CompareHelper.isRecord(e)?this._type=a.RECORD:n.CompareHelper.isObject(e)?this._type=a.OBJECT:n.CompareHelper.isFunction(e)?this._type=a.FUNCTION:this._type=a.PRIMITIVE}get type(){return this._type}get isValuable(){return this._type!==a.NO_EVALUABLE}get isPrimitive(){return this._type===a.PRIMITIVE}get isArray(){return this._type===a.ARRAY}get isObject(){return this._type===a.OBJECT}get isRecord(){return this._type===a.RECORD}get isFunction(){return this._type===a.FUNCTION}}},(e,t,r)=>{r.r(t),r.d(t,{Path:()=>n});var a=r(1);class n extends Array{add(e){return super.push(e),this}clone(){return this.slice()}slice(e,t){const r=new n;return r.push(...super.slice(e,t)),r}toString(){return this.reduce(((e,t)=>e+(a.CompareHelper.isNumber(t)?`[${t}]`:`${""===e?"":"."}${t}`)),"")}last(){return this.length>0?this[this.length-1]:void 0}}},(e,t,r)=>{r.r(t),r.d(t,{CompareEngine:()=>i});var a=r(5),n=r(7),o=r(1),s=r(3);class i{determineArrayIndexFn;compareStateIndex;arrayIndex;panels;_logsEnabled=!1;constructor(e,t,r){this.determineArrayIndexFn=e,this.compareStateIndex={left:new Map,right:new Map},this.arrayIndex={left:new Map,right:new Map},this.panels={left:t,right:r}}set logsEnabled(e){this._logsEnabled=e}get leftValue(){return o.CompareHelper.deepClone(this.panels[n.PanelEnum.LEFT])}get rightValue(){return o.CompareHelper.deepClone(this.panels[n.PanelEnum.RIGHT])}updateLeft(e){this.update(n.PanelEnum.LEFT,e)}updateRight(e){this.update(n.PanelEnum.RIGHT,e)}leftToRight(){this.updateRight(this.panels[n.PanelEnum.LEFT])}rightToLeft(){this.updateLeft(this.panels[n.PanelEnum.RIGHT])}updateCompareIndex(){this.compareStateIndex[n.PanelEnum.LEFT].clear(),this.compareStateIndex[n.PanelEnum.RIGHT].clear(),this.compare(n.PanelEnum.LEFT,this.panels[n.PanelEnum.LEFT]),this.compare(n.PanelEnum.RIGHT,this.panels[n.PanelEnum.RIGHT])}hasChange(){return this.compareStateIndex.right.get("")?.isChanged??!1}getLeftState(e){return this.getState(n.PanelEnum.LEFT,e)}getRightState(e){return this.getState(n.PanelEnum.RIGHT,e)}getState(e,t){const r=s.Path.from(o.CompareHelper.isArray(t)?t:[t]);return this._logsEnabled&&console.log(`- [${e}] Get state :`,t,r),this.compareStateIndex[e].get(r.toString())??a.CompareState.NONE}update(e,t){this.panels[e]=o.CompareHelper.deepClone(t),this.arrayIndex[e].clear()}findArrayDiffLevels(e,t,r=0,a=[],n=!1){const o=t.slice(0,r),s=this.arrayIndex[e].get(o.toString())??!1;return n&&(console.log("--- findArrayDiffLevels : level ",r," with path ",t),console.log("--- findArrayDiffLevels : currentPath '",o,"' is array ? ",s)),a.length>0&&(a=a.map((e=>e+1))),s&&a.push(0),r<t.length?this.findArrayDiffLevels(e,t,r+1,a,n):a}findCompareItem(e,t,r){let a;if(r&&o.CompareHelper.hasProperty(e,[r])&&o.CompareHelper.hasStringIndex(e))a=t.findIndex((t=>t[r]===e[r]));else{a=t.map((e=>JSON.stringify(e))).indexOf(JSON.stringify(e))}return{index:a,value:t[a]}}comparePropertyValues(e,t,r,n,s=!1){if(s&&(console.log("--- Compare property value",n.toString(),o.CompareHelper.hasProperty(r,n)?"exist":"not exist"),console.log("--- in object",r)),!o.CompareHelper.hasProperty(r,n))return this.getIncomparableState(e);const i=o.CompareHelper.getIn(r,n);return s&&(console.log("--- Is equal ?",o.CompareHelper.isEqual(t,i)),console.log("--- Other side value",i)),o.CompareHelper.isEqual(t,i)?a.CompareState.EQUAL:a.CompareState.UPDATED}getIncomparableState(e){return e===n.PanelEnum.LEFT?a.CompareState.REMOVED:a.CompareState.ADDED}compareValues(e,t){return o.CompareHelper.isEqual(e,t)?a.CompareState.EQUAL:a.CompareState.UPDATED}compare(e,t,r=new s.Path){let i,l=this._logsEnabled,p=a.CompareState.NONE;const u=e===n.PanelEnum.LEFT?n.PanelEnum.RIGHT:n.PanelEnum.LEFT;o.CompareHelper.isEvaluable(t)&&!o.CompareHelper.isPrimitive(t)&&this.arrayIndex[e].set(r.toString(),o.CompareHelper.isArray(t)),l&&(console.log(`- [${e}] ${r}`),console.log("-- Side value : ",t));const c=this.findArrayDiffLevels(e,r,0,[],l);l&&console.log("-- Array diffs : ",c);let m=this.panels[e],g=this.panels[u],h=r.clone(),d=o.CompareHelper.deepClone(t);if(c.length>0?c.forEach((t=>{const r=h.slice(0,h.length-t),n=o.CompareHelper.getIn(g,r);if(l&&(console.log("--- Current array diff : ",t),console.log("--- Current root : ",m),console.log("--- Current side value : ",d),console.log("--- Array path : ",r),console.log("--- Other side items : ",n),console.log("--- Other side is array ?",o.CompareHelper.isArray(n))),o.CompareHelper.isArray(n))if(0===t)d=o.CompareHelper.getIn(m,r),l&&(console.log("-- Array diff 0"),console.log("-- Property path : ",r),console.log("-- Compare : ",d),console.log("-- With : ",n)),p=this.comparePropertyValues(e,d,g,r,l);else{const s=this.determineArrayIndexFn?this.determineArrayIndexFn(h):"",u=h.slice(0,r.length+1),c=o.CompareHelper.getIn(m,u),E=this.findCompareItem(c,n,s),y=E.value;if(l&&(console.log("-- Object path : ",u),console.log("-- Side object : ",c),console.log("-- Item finded ? ",E)),y){const r=h.slice(u.length);if(1===t){const e=h.last();if(void 0!==e){d=o.CompareHelper.getIn(c,r),l&&(console.log("-- Array diff 1",r),console.log("-- Other side value : ",E.value),console.log("-- Indexes : ",e,E.index));const t=this.compareValues(e,E.index),n=this.compareValues(d,E.value);l&&(console.log("-- compare index : ",t.value),console.log("-- compare value : ",n.value)),p=t.isUpdated&&n.isEqual?a.CompareState.MOVED:n.isUpdated?a.CompareState.UPDATED:a.CompareState.EQUAL}}else d=o.CompareHelper.getIn(c,r),l&&(i=o.CompareHelper.getIn(y,r),console.log("-- Array diff > 1",r),console.log("-- Other side object : ",y),console.log("-- Other side value : ",i)),p=this.comparePropertyValues(e,d,y,r,l);h=r.clone(),m=o.CompareHelper.deepClone(c),d=o.CompareHelper.deepClone(c),g=o.CompareHelper.deepClone(y),l&&(i=o.CompareHelper.deepClone(y))}else p=this.getIncomparableState(e)}else d=o.CompareHelper.getIn(m,r),l&&(console.log("-- No other side array"),console.log("-- Compare",d),console.log("-- With",n)),p=this.comparePropertyValues(e,d,g,r,l)})):(p=this.comparePropertyValues(e,d,this.panels[u],r),l&&(i=o.CompareHelper.getIn(this.panels[u],r),console.log("-- No array upside"),console.log("-- Other side value : ",i))),l&&console.log("-- Update state with : ",p.value),this.compareStateIndex[e].set(r.toString(),p),p.isUpdated&&o.CompareHelper.isTree(t)){const a=o.CompareHelper.keys(t);l&&console.log("-- Sub keys : ",a),a.forEach((a=>{const n=r.clone().add(a);this._logsEnabled&&console.log("-- Sub path :",r,"+",a,"=>",n);const s=o.CompareHelper.isArray(t)?t[o.CompareHelper.parseInt(a)]:t[a];this.compare(e,s,n)}))}}}},(e,t,r)=>{r.r(t),r.d(t,{CompareState:()=>n});var a=r(6);class n{_value;constructor(e=a.CompareStateEnum.NONE){this._value=e}static get NONE(){return new n}static get ADDED(){return new n(a.CompareStateEnum.ADDED)}static get MOVED(){return new n(a.CompareStateEnum.MOVED)}static get UPDATED(){return new n(a.CompareStateEnum.UPDATED)}static get REMOVED(){return new n(a.CompareStateEnum.REMOVED)}static get EQUAL(){return new n(a.CompareStateEnum.EQUAL)}get value(){return this._value}get isNone(){return this._value===a.CompareStateEnum.NONE}get isAdded(){return this._value===a.CompareStateEnum.ADDED}get isMoved(){return this._value===a.CompareStateEnum.MOVED}get isUpdated(){return this._value===a.CompareStateEnum.UPDATED}get isRemoved(){return this._value===a.CompareStateEnum.REMOVED}get isEqual(){return this._value===a.CompareStateEnum.EQUAL}get isChanged(){return this._value!==a.CompareStateEnum.EQUAL}toString(){return this.value}}},(e,t,r)=>{var a;r.r(t),r.d(t,{CompareStateEnum:()=>a}),function(e){e.NONE="",e.ADDED="added",e.MOVED="moved",e.UPDATED="updated",e.REMOVED="removed",e.EQUAL="equal"}(a||(a={}))},(e,t,r)=>{var a;r.r(t),r.d(t,{PanelEnum:()=>a}),function(e){e.LEFT="left",e.RIGHT="right"}(a||(a={}))},(e,t,r)=>{r.r(t)}],t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{r.r(a),r.d(a,{CompareEngine:()=>t.CompareEngine,CompareHelper:()=>e.CompareHelper,CompareState:()=>o.CompareState,CompareStateEnum:()=>n.CompareStateEnum,Path:()=>s.Path,TypeState:()=>i.TypeState,TypeStateEnum:()=>i.TypeStateEnum});var e=r(1),t=r(4),n=r(6),o=r(5),s=(r(8),r(3)),i=r(2)})();var n=a.CompareEngine,o=a.CompareHelper,s=a.CompareState,i=a.CompareStateEnum,l=a.Path,p=a.TypeState,u=a.TypeStateEnum;export{n as CompareEngine,o as CompareHelper,s as CompareState,i as CompareStateEnum,l as Path,p as TypeState,u as TypeStateEnum};